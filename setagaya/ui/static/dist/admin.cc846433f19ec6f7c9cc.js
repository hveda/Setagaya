/*! For license information please see admin.cc846433f19ec6f7c9cc.js.LICENSE.txt */
(()=>{function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach(function(r){t(e,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))})}return e}function t(r,n,t){return(n=function(r){var n=function(r){if("object"!=e(r)||!r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var t=n.call(r,"string");if("object"!=e(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(r);return"symbol"==e(n)?n:n+""}(n))in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t,r}function o(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,o,a,s,i=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;c=!1}else for(;!(c=(t=a.call(n)).done)&&(i.push(t.value),i.length!==r);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return a(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=Array(r);n<r;n++)t[n]=e[n];return t}function s(){var e,r,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,t,o,a){var s=t&&t.prototype instanceof u?t:u,l=Object.create(s.prototype);return i(l,"_invoke",function(n,t,o){var a,s,i,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(r,n){return a=r,s=0,i=e,f.n=n,c}};function p(n,t){for(s=n,i=t,r=0;!d&&u&&!o&&r<l.length;r++){var o,a=l[r],p=f.p,m=a[2];n>3?(o=m===t)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(s=0,f.v=t,f.n=a[1]):p<m&&(o=n<3||a[0]>t||t>m)&&(a[4]=n,a[5]=t,f.n=m,s=0))}if(o||n>1)return c;throw d=!0,t}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,m),s=l,i=m;(r=s<2?e:i)||!d;){a||(s?s<3?(s>1&&(f.n=-1),p(s,i)):f.n=i:f.v=i);try{if(u=2,a){if(s||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,s<2&&(s=0)}else 1===s&&(r=a.return)&&r.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((r=(d=f.n<0)?i:n.call(t,f))!==c)break}catch(r){a=e,s=1,i=r}finally{u=1}}return{value:r,done:d}}}(n,o,a),!0),l}var c={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][t]?r(r([][t]())):(i(r={},t,function(){return this}),r),p=d.prototype=u.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,i(p,"constructor",d),i(d,"constructor",l),l.displayName="GeneratorFunction",i(d,o,"GeneratorFunction"),i(p),i(p,o,"Generator"),i(p,t,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:a,m}})()}function i(e,r,n,t){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,r,n,t){function a(r,n){i(e,r,function(e){return this._invoke(r,n,e)})}r?o?o(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(a("next",0),a("throw",1),a("return",2))},i(e,r,n,t)}function c(e,r,n,t,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?r(c):Promise.resolve(c).then(t,o)}function u(e){return function(){var r=this,n=arguments;return new Promise(function(t,o){var a=e.apply(r,n);function s(e){c(a,t,o,s,i,"next",e)}function i(e){c(a,t,o,s,i,"throw",e)}s(void 0)})}}var l={admin:{component:"adminRoot",title:"Admin Dashboard"},"admin/collections":{component:"collectionAdmin",title:"Collection Management"},"admin/users":{component:"userManagement",title:"User Management"},"admin/roles":{component:"roleManagement",title:"Role Management"}};window.adminRouter={currentRoute:null,navigate:function(e){this.currentRoute=e,window.location.hash=e},getComponent:function(e){var r=l[e.replace("#","")];return r?r.component:null},getTitle:function(e){var r=l[e.replace("#","")];return r?r.title:"Admin"}},window.createAdminComponent=function(e){switch(e){case"adminRoot":default:return{activeTab:"overview",userStats:{totalUsers:0,activeUsers:0,adminUsers:0},systemStats:{runningCollections:0,totalProjects:0,systemLoad:0},init:function(){var e=this;return u(s().m(function r(){return s().w(function(r){for(;;)switch(r.n){case 0:if(window.authManager.hasPermission("system:admin")){r.n=1;break}return alert("Access denied: Admin privileges required"),window.location.hash="#",r.a(2);case 1:return r.n=2,e.loadStats();case 2:console.log("Admin interface initialized");case 3:return r.a(2)}},r)}))()},loadStats:function(){var e=this;return u(s().m(function r(){var t,a,i,c,u;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,Promise.all([axios.get("/api/rbac/users"),axios.get("/api/admin/stats")]);case 1:t=r.v,a=o(t,2),i=a[0],c=a[1],i.data&&i.data.users&&(e.userStats.totalUsers=i.data.users.length,e.userStats.activeUsers=i.data.users.filter(function(e){return e.active}).length,e.userStats.adminUsers=i.data.users.filter(function(e){return e.roles&&e.roles.some(function(e){return"administrator"===e.name})}).length),c.data&&(e.systemStats=n(n({},e.systemStats),c.data)),r.n=3;break;case 2:r.p=2,u=r.v,console.error("Failed to load admin stats:",u);case 3:return r.a(2)}},r,null,[[0,2]])}))()},setActiveTab:function(e){this.activeTab=e}};case"collectionAdmin":return{running_collections:[],node_pools:{},loading:!1,error:null,syncInterval:null,init:function(){var e=this;return u(s().m(function r(){return s().w(function(r){for(;;)switch(r.n){case 0:if(window.authManager.hasPermission("collections:read_all")){r.n=1;break}return e.error="Access denied: Collection admin privileges required",r.a(2);case 1:return r.n=2,e.fetchRunningCollections();case 2:e.syncInterval=setInterval(function(){return e.fetchRunningCollections()},5e3),console.log("Collection admin initialized");case 3:return r.a(2)}},r)}))()},destroy:function(){this.syncInterval&&clearInterval(this.syncInterval)},fetchRunningCollections:function(){var e=this;return u(s().m(function r(){var n,t;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,e.loading=!0,r.n=1,axios.get("/api/admin/collections");case 1:(n=r.v).data&&(e.running_collections=n.data.running_collections||[],e.node_pools=n.data.node_pools||{},e.error=null),r.n=3;break;case 2:r.p=2,t=r.v,console.error("Failed to fetch running collections:",t),e.error="Failed to load collection data";case 3:return r.p=3,e.loading=!1,r.f(3);case 4:return r.a(2)}},r,null,[[0,2,3,4]])}))()},collectionUrl:function(e){return"#collections/".concat(e)},formatTime:function(e){return e?new Date(e).toLocaleString():"N/A"},getStatusBadgeClass:function(e){return{running:"bg-success",completed:"bg-primary",failed:"bg-danger",pending:"bg-warning"}[e]||"bg-secondary"}};case"userManagement":return{users:[],roles:[],selectedUser:null,showUserModal:!1,showRoleModal:!1,loading:!1,error:null,searchTerm:"",newUser:{username:"",full_name:"",email:"",active:!0},newRole:{name:"",description:"",permissions:[]},init:function(){var e=this;return u(s().m(function r(){return s().w(function(r){for(;;)switch(r.n){case 0:if(window.authManager.hasPermission("users:read")){r.n=1;break}return e.error="Access denied: User management privileges required",r.a(2);case 1:return r.n=2,Promise.all([e.loadUsers(),e.loadRoles()]);case 2:console.log("User management initialized");case 3:return r.a(2)}},r)}))()},loadUsers:function(){var e=this;return u(s().m(function r(){var n,t;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,e.loading=!0,r.n=1,axios.get("/api/rbac/users");case 1:n=r.v,e.users=n.data.users||[],r.n=3;break;case 2:r.p=2,t=r.v,console.error("Failed to load users:",t),e.error="Failed to load users";case 3:return r.p=3,e.loading=!1,r.f(3);case 4:return r.a(2)}},r,null,[[0,2,3,4]])}))()},loadRoles:function(){var e=this;return u(s().m(function r(){var n,t;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,axios.get("/api/rbac/roles");case 1:n=r.v,e.roles=n.data.roles||[],r.n=3;break;case 2:r.p=2,t=r.v,console.error("Failed to load roles:",t);case 3:return r.a(2)}},r,null,[[0,2]])}))()},get filteredUsers(){var e=this;return this.searchTerm?this.users.filter(function(r){return r.username.toLowerCase().includes(e.searchTerm.toLowerCase())||r.full_name.toLowerCase().includes(e.searchTerm.toLowerCase())||r.email.toLowerCase().includes(e.searchTerm.toLowerCase())}):this.users},createUser:function(){var e=this;return u(s().m(function r(){var n;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:if(window.authManager.hasPermission("users:create")){r.n=1;break}return alert("Access denied: Cannot create users"),r.a(2);case 1:return r.p=1,r.n=2,axios.post("/api/rbac/users",e.newUser);case 2:return r.n=3,e.loadUsers();case 3:e.showUserModal=!1,e.resetNewUser(),r.n=5;break;case 4:r.p=4,n=r.v,console.error("Failed to create user:",n),alert("Failed to create user");case 5:return r.a(2)}},r,null,[[1,4]])}))()},updateUser:function(e){var r=this;return u(s().m(function n(){var t;return s().w(function(n){for(;;)switch(n.p=n.n){case 0:if(window.authManager.hasPermission("users:update")){n.n=1;break}return alert("Access denied: Cannot update users"),n.a(2);case 1:return n.p=1,n.n=2,axios.put("/api/rbac/users/".concat(e.id),e);case 2:return n.n=3,r.loadUsers();case 3:n.n=5;break;case 4:n.p=4,t=n.v,console.error("Failed to update user:",t),alert("Failed to update user");case 5:return n.a(2)}},n,null,[[1,4]])}))()},deleteUser:function(e){var r=this;return u(s().m(function n(){var t;return s().w(function(n){for(;;)switch(n.p=n.n){case 0:if(window.authManager.hasPermission("users:delete")){n.n=1;break}return alert("Access denied: Cannot delete users"),n.a(2);case 1:if(confirm("Are you sure you want to delete user ".concat(e.username,"?"))){n.n=2;break}return n.a(2);case 2:return n.p=2,n.n=3,axios.delete("/api/rbac/users/".concat(e.id));case 3:return n.n=4,r.loadUsers();case 4:n.n=6;break;case 5:n.p=5,t=n.v,console.error("Failed to delete user:",t),alert("Failed to delete user");case 6:return n.a(2)}},n,null,[[2,5]])}))()},assignRole:function(e,r){var n=this;return u(s().m(function t(){var o;return s().w(function(t){for(;;)switch(t.p=t.n){case 0:if(window.authManager.hasPermission("users:assign_roles")){t.n=1;break}return alert("Access denied: Cannot assign roles"),t.a(2);case 1:return t.p=1,t.n=2,axios.post("/api/rbac/users/".concat(e,"/roles"),{role_id:r});case 2:return t.n=3,n.loadUsers();case 3:t.n=5;break;case 4:t.p=4,o=t.v,console.error("Failed to assign role:",o),alert("Failed to assign role");case 5:return t.a(2)}},t,null,[[1,4]])}))()},resetNewUser:function(){this.newUser={username:"",full_name:"",email:"",active:!0}},selectUser:function(e){this.selectedUser=n({},e)}};case"roleManagement":return{roles:[],permissions:[],selectedRole:null,showRoleModal:!1,loading:!1,error:null,newRole:{name:"",description:"",permission_ids:[]},init:function(){var e=this;return u(s().m(function r(){return s().w(function(r){for(;;)switch(r.n){case 0:if(window.authManager.hasPermission("roles:read")){r.n=1;break}return e.error="Access denied: Role management privileges required",r.a(2);case 1:return r.n=2,Promise.all([e.loadRoles(),e.loadPermissions()]);case 2:console.log("Role management initialized");case 3:return r.a(2)}},r)}))()},loadRoles:function(){var e=this;return u(s().m(function r(){var n,t;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,e.loading=!0,r.n=1,axios.get("/api/rbac/roles");case 1:n=r.v,e.roles=n.data.roles||[],r.n=3;break;case 2:r.p=2,t=r.v,console.error("Failed to load roles:",t),e.error="Failed to load roles";case 3:return r.p=3,e.loading=!1,r.f(3);case 4:return r.a(2)}},r,null,[[0,2,3,4]])}))()},loadPermissions:function(){var e=this;return u(s().m(function r(){var n,t;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,axios.get("/api/rbac/permissions");case 1:n=r.v,e.permissions=n.data.permissions||[],r.n=3;break;case 2:r.p=2,t=r.v,console.error("Failed to load permissions:",t);case 3:return r.a(2)}},r,null,[[0,2]])}))()},createRole:function(){var e=this;return u(s().m(function r(){var n;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:if(window.authManager.hasPermission("roles:create")){r.n=1;break}return alert("Access denied: Cannot create roles"),r.a(2);case 1:return r.p=1,r.n=2,axios.post("/api/rbac/roles",e.newRole);case 2:return r.n=3,e.loadRoles();case 3:e.showRoleModal=!1,e.resetNewRole(),r.n=5;break;case 4:r.p=4,n=r.v,console.error("Failed to create role:",n),alert("Failed to create role");case 5:return r.a(2)}},r,null,[[1,4]])}))()},updateRole:function(e){var r=this;return u(s().m(function n(){var t;return s().w(function(n){for(;;)switch(n.p=n.n){case 0:if(window.authManager.hasPermission("roles:update")){n.n=1;break}return alert("Access denied: Cannot update roles"),n.a(2);case 1:return n.p=1,n.n=2,axios.put("/api/rbac/roles/".concat(e.id),e);case 2:return n.n=3,r.loadRoles();case 3:n.n=5;break;case 4:n.p=4,t=n.v,console.error("Failed to update role:",t),alert("Failed to update role");case 5:return n.a(2)}},n,null,[[1,4]])}))()},deleteRole:function(e){var r=this;return u(s().m(function n(){var t;return s().w(function(n){for(;;)switch(n.p=n.n){case 0:if(window.authManager.hasPermission("roles:delete")){n.n=1;break}return alert("Access denied: Cannot delete roles"),n.a(2);case 1:if(confirm("Are you sure you want to delete role ".concat(e.name,"?"))){n.n=2;break}return n.a(2);case 2:return n.p=2,n.n=3,axios.delete("/api/rbac/roles/".concat(e.id));case 3:return n.n=4,r.loadRoles();case 4:n.n=6;break;case 5:n.p=5,t=n.v,console.error("Failed to delete role:",t),alert("Failed to delete role");case 6:return n.a(2)}},n,null,[[2,5]])}))()},resetNewRole:function(){this.newRole={name:"",description:"",permission_ids:[]}},selectRole:function(e){this.selectedRole=n({},e)}}}}})();
//# sourceMappingURL=admin.cc846433f19ec6f7c9cc.js.map